<center><font size=6>数字图像处理Project2</font></center>

<center>姓名：吴宇祺   学号：16340242</center>

[TOC]

## 题目

1. 采用一阶Butterworth低通滤波器对给定图像’barb.bnsg‘进行频域滤波。当$D_0=10,20,40,80$时，给出相应滤波图像，并分别以频域和空域的观点解释有关滤波结果。

2. 采用同态滤波来增强图像’office.jpg‘细节，对数频域滤波器为
   $$
   H(u,v) = (\gamma_H-\gamma_L)[1-e-c\frac{D^2(u,v)}{D_0^2}]+\gamma_L
   $$

   1. 参数选择：参考$\gamma_H = 2\ \ \ \ \ \ \gamma_L = 0.25, C = 1$
   2. 尝试不同的$D_0$得到最好的结果
   3. 将滤波器替换为一阶Butterworth高通滤波器，比较滤波效果。

## 算法实现

### 一阶巴特沃斯低通滤波器

1. 对输入图像进行零扩展、中心变换，并将像素矩阵转换为双精度浮点数处理：

   ```matlab
   f = zeros(2*M, 2*N);
   for i = 1:M
       for j = 1:N
          f(i,j) = double(img(i,j))*(-1)^(i+j);
       end
   end
   ```

2. 对图像进行（二维）离散傅里叶变换

   ```matlab
   F = fft2(f)
   ```

3. 用滤波函数H(u,v)乘以F(u,v)：一阶巴特沃夫低通滤波器：
   $$
   H(u,v) = \frac{1}{1+\frac{u^2+v^2}{D_0^2}}
   $$

   ```matlab
   G = zeros(2*M, 2*N);
   for u = 1:2*M
       for v = 1:2*N
          %计算u,v点的滤波函数
          H = 1 / (1 + ((u-(M+1))^2 + (v-(N+1))^2) / D0_2);
          G(u,v) = F(u,v) * H;
       end
   end
   ```

4. 对F进行二维傅里叶反变换 DFT，得到实部

   ```matlab
   G = real(ifft2(G));
   ```


5. 反中心化处理
   ```matlab
   for i = 1:M
       for j = 1:N
          g(i,j) = G(i,j)*((-1)^(i+j));
       end
   end
   ```



### 同态滤波

1. 对输入图像进行零扩展、取对数、中心变换处理：由于光照影响属于乘性噪声，将光照影响转换为传统噪声模型：

   ```matlab
   for i = 1:M
       for j = 1:N
          f(i,j) = log(double(img(i,j)) + 1)*(-1)^(i+j);
       end
   end
   ```

2. 对图像进行（二维）离散傅里叶变换（同题1）


3. 用滤波函数H(u,v)乘以F(u,v)：同态滤波函数：为了减少由于光照不均造成的图像暗处细节模糊，增强图像的对比度。
   $$
   H(u,v) = (\gamma_H-\gamma_L)[1-e-c\frac{D^2(u,v)}{D_0^2}]+\gamma_L
   $$

   ```matlab
   G = zeros(2*M, 2*N);
   for u = 1:2*M
       for v = 1:2*N
           k = ((u-(M+1))^2 + (v-(N+1))^2) / D0_2;
           H = r * (1 - exp((-C) * k))+ l;
           G(u,v) = F(u,v) * H;
       end
   end
   ```

4. 对F进行二维傅里叶反变换 DFT并取结果的实部（同题1）

5. 进行反中心化、取自然指数处理

   ```matlab
         g(i,j) = exp(G(i,j)*(-1)^(i+j)) - 1; #遍历矩阵g
   ```

6. 归一化图像取得显示效果：



   ```matlab
   max_data = max(g(:));
   min_data = min(g(:));
   range = max_data - min_data;
   for i = 1 : M
       for j = 1 : N
           g(i,j) = uint8(255 * (g(i, j)-min_data) / range);
       end
   end
   g = uint8(g)
   ```


## 测试与分析

### 一阶巴特沃斯低通滤波器

输入图像：

![barb](D:\学习资料\grade3-1\数字图像处理\HW\3\src\barb.png)

实验结果：

| D0 = 10                                                     | D0=20                                                       | D0=40                                                       | D0=80                                                       |
| ----------------------------------------------------------- | ----------------------------------------------------------- | ----------------------------------------------------------- | ----------------------------------------------------------- |
| ![10](D:\学习资料\grade3-1\数字图像处理\HW\3\result\10.png) | ![10](D:\学习资料\grade3-1\数字图像处理\HW\3\result\20.png) | ![10](D:\学习资料\grade3-1\数字图像处理\HW\3\result\40.png) | ![10](D:\学习资料\grade3-1\数字图像处理\HW\3\result\80.png) |

分析：滤波结果没有出现明显的振铃现象，图像的清晰程度随着D0的增大而增大。由于在频域内，一阶巴特沃斯低通滤波器对频率成分随着(u, v)的增加而逐渐衰减（u，v在分子），振铃现象被有效抑制。对于同一u,v，随着截止频率D0的增大，对应频率成分增大，即更多（相对）高频的频率保留，即保留了更多细节，图像更清晰。



### 同态滤波

输入图像：

![office](D:\学习资料\grade3-1\数字图像处理\HW\3\src\office.jpg)

1. D0取500~600时效果比较好，图片细节，例如书台左边的靠背椅子等细节比较清晰：

| D0 = 100                                                     | D0=200                                                       | D0=300                                                       | D0=400                                                       | D0=500                                                       |
| ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| ![homo100](D:\学习资料\grade3-1\数字图像处理\HW\3\result\homo100.jpg) | ![homo100](D:\学习资料\grade3-1\数字图像处理\HW\3\result\homo200.jpg) | ![homo100](D:\学习资料\grade3-1\数字图像处理\HW\3\result\homo300.jpg) | ![homo100](D:\学习资料\grade3-1\数字图像处理\HW\3\result\homo400.jpg) | ![homo100](D:\学习资料\grade3-1\数字图像处理\HW\3\result\homo500.jpg) |
| D0=600                                                       | D0=700                                                       | D0=800                                                       | D0=900                                                       | D0=1000                                                      |
| ![homo100](D:\学习资料\grade3-1\数字图像处理\HW\3\result\homo600.jpg) | ![homo100](D:\学习资料\grade3-1\数字图像处理\HW\3\result\homo700.jpg) | ![homo100](D:\学习资料\grade3-1\数字图像处理\HW\3\result\homo800.jpg) | ![homo100](D:\学习资料\grade3-1\数字图像处理\HW\3\result\homo900.jpg) | ![homo100](D:\学习资料\grade3-1\数字图像处理\HW\3\result\homo1000.jpg) |

2. 取D0=600和一阶巴特沃斯高通滤波器结果比较：

   桌子左边阴影处的细节受到由于光照变化产生的乘性噪声影响，变换缓慢，频率集中在低频部分。巴特沃斯高通滤波认为这部分是低频并过滤掉，保留光照强烈出丰富的高频分量；而同态滤波器效果较好。

   | 同态滤波（D0 = 600）                                         | 一阶Butterworth高通滤波器（D0 = 0.001）                      |
   | ------------------------------------------------------------ | ------------------------------------------------------------ |
   | ![homo600](D:\学习资料\grade3-1\数字图像处理\HW\3\result\homo600.jpg) | ![BwH](D:\学习资料\grade3-1\数字图像处理\HW\3\result\BwH.jpg) |
